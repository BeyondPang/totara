<h1>导入&ldquo;课程测试管理器&rdquo;文件</h1>

<p>课程测试管理器是来自课程技术的终极软件包。Course Technology 已停止对该软件包的开发。它已被名为 ExamView 的新测试管理器取代。但是，永远不存在迁移路径，用于从 CTM 测试库将这种格式导出为任何其他普通测试格式。这就是编写此模块的缘由。</p>

<p> 要从 CTM 导入问题，必须在 Windows 操作系统的机器上安装 CTM，而且在该机器上要能够访问 MS Access 数据文件。首先要具备两个数据文件:</p>
<ul><li>System.mda - 此文件位于 CTM 安装的顶层目录中，并且该文件与作为&ldquo;系统数据库&rdquo;的 MS 访问用语有关。</li>
<li>ctm.mdb - 这是包含测试库问题的数据库。CTM 中安装的每个课程都带有一个这样的数据库。它位于 CTM 安装目录的下一级目录。</li>
</ul>

</p>根据您运行 Moodle 的操作系统的不同（Windows 或者 Linux），导入的过程也有所不同。尽管 Moodle 所运行的平台不同，但是在同一个网络中必须装有一个 Windows 系统（Windows 2000 或 Windows XP）作为 Moodle 系统，以便导入测试库的时候能够作为访问数据库的主机系统。</p>

<p>在<b>基于 Windows</b> 的 Moodle 系统上，导入过程会更容易。您只需要执行以下步骤来使用 CTM 导入类：</p>

<ol><li>通过文件管理器将 system.mda 系统数据库上传到 moodle 中。它与您上传到 system.mda 文件的课程内容无关。Moodle 终将找到该数据库。</li>
<li>创建您的测试，并且进入&ldquo;从文件中导入问题&rdquo;进程。上传您所选的作为导入文件的 ctm.mdb 数据库。如果此操作错误，您将会看到另一个屏幕，您可从此屏幕中选择问题的子类别作为从数据库导入的目标。在这里需要此步骤的理由是 CTM 测试库通常包含大量按书本章节或课程章节分类的问题。</li>
</ol>

<p><b>基于 Linux</b> 的 Moodle 系统上的此过程包含名为 <a href="http://odbcsock.sourceforge.net/" target="_new"><b>ODBC Socket Server</b></a> 的第三方软件组件。为了能够在 Linux 上导入 CTM 数据库，您必须将这个小的网络程序下载并安装在要作为 CTM 数据库主机系统的 Windows 系统上。<b>请勿</b>执行&ldquo;ODBC Socket Server 安装&rdquo;中概括的安装步骤。因为它们过于复杂！请直接执行以下步骤将此程序安装在 Windows 系统上：</p>

<ol><li>转到 Windows 系统，并在 Windows 系统上解压从<a href="http://odbcsock.sourceforge.net/" target="_new">此网站</a>下载的安装文件。</li>
<li>将二进制的 ODBCSocketServer.exe 复制到永久位置，例如系统目录（可能为 C:\WINNT\ 或 C:\Windows）或您的 Program Files 目录。 </li>

<li>用以下命令将 ODBC Socket Server 作为服务安装在系统上：<br /><b>&lt;您通过以上步骤将此文件复制到的目标路劲&gt;ODBCSocketServer.exe /Service</b><br />您可以通过&ldquo;开始&rdquo;菜单中的&ldquo;运行&rdquo;对话框或通过命令提示框键入该命令同，来执行对应的操作。</li>

<li>可通过以两种方式打开服务管理器：进入&ldquo;开始&rdquo;菜单-&gt;设置-&gt;控制面板-&gt;管理工具-&gt;服务器，或右键单击<b>我的电脑</b>，选择<b>管理</b>，然后从右面板中选择<b>服务和应用程序-&gt;服务</b>。同样，您也可以在&ldquo;开始&rdquo;菜单的&ldquo;运行&rdquo;对话框中键入 <b>services.msc</b> 来访问服务管理器</li>

<li>在服务管理器中，右键单击 ODBC Socket Server 项目，并选择<b>开始</b>项。其状态在您执行此操作时变为&ldquo;已启动&rdquo;。注意，您可能需要在完全停止和/或禁用此服务之前，完成导入进程。</li>

<li>确保您的电脑上有 system.mda 和 ctm.mdb 数据文件，同时 MS Access ODBC 驱动程序也存在。它会在标准 Windows 安装过程中安装。您可以确定该驱动器是否是通过打开&ldquo;管理工具&rdquo;中的&ldquo;数据源&rdquo;项并借助&ldquo;驱动程序&rdquo;选项卡安装的。您将必须确定 CTM 的安装位置，并找到 system.mda 文件和 ctm.mdb 数据库，或找到您打算从中导入数据的源数据库。记录好这些文件的完整路劲，以及 Windows 服务器的 IP 地址或主机名称。您在接下来的导入过程中也会用到这些信息。</li>

<li>现在您可以将一个或多个测试库导入 Moodle 中。创建您的测试，并且进入&ldquo;从文件中导入问题&rdquo;进程。<b> LINUX 系统上的一些不同操作</b> ---您必须在上传字段中指定一个虚拟文件才能开始导入。这个文件<b>将不会</b>被处理，它只是导入表格的占位符。然后您会得到用于随后指定 Windows 服务器信息的位置。接下来，您会看到一个屏幕，您可以在其中键入 Windows ODBC Socket Server 机器的主机名以及进入系统和题库的路径。键入您上一步写下的信息并点击&ldquo;连接到服务器&rdquo;。如果正确设置了每一步，您就可以得到另一个表格，允许您选择要从数据库导入的问题子类别。在这里需要此步骤的理由是 CTM 测试库通常包含大量按书本章节或课程章节分类的问题。如果您转到此步骤且未收到任何错误消息，则表示您已正确设置了 ODBC Socket server，而且可以开始将问题导入 Moodle 了。</li>
</ol>

<p>如果您在这此过程中收到错误信息，您会发现以上的技术信息是很有用的。ODBC Socket Server 会使用端口 9628 来打开一个套接字、交易以及与查询结果的 XML 结果表对应的 XML 查询。导入类将分析该 XML 并使用它，就像我使用本地查询来执行导入一样。
</p>
