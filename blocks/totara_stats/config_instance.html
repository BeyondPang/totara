<?php

require_once($CFG->dirroot.'/blocks/totara_stats/locallib.php');

global $USER;

$role = totara_stats_get_dashrole($this->instance->pageid);

//now get sql required to return stats
$stats = totara_stats_build_sql($role, $USER);

    if (empty($stats)) {
        exit;
    }
?>

<table cellpadding="9" cellspacing="0" class="blockconfigtable">
<?php
foreach ($stats as $stat) {
$varname = $stat->string;
?>
    <tr valign="top">
    <td align="right"><?php print_string($stat->string.'_config', 'block_totara_stats'); ?>:</td>
    <td><input type="checkbox" name="<?php echo $varname; ?>" <?php echo !empty($this->config->$varname)?'CHECKED':''; ?> />
    <?php if ($stat->string == 'statlearnerhours') {
        print_string('statlearnerhours_confighours', 'block_totara_stats');
    ?>
              <input type="text" maxlength="2"  size="2" name="statlearnerhours_hours" value="<?php echo isset($this->config->statlearnerhours_hours)?p($this->config->statlearnerhours_hours):''; ?>"/>
    <?php
          }
    ?>
    </td>
</tr>
<?php
}
?>
<tr>
    <td colspan="3" align="center">
    <input type="submit" value="<?php print_string('savechanges') ?>" /></td>
</tr>
</table>

