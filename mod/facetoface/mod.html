<?php
    if (empty($form->name)) {
        $form->name = '';
    }
    if (empty($form->thirdparty)) {
        $form->thirdparty = '';
    }
    if (empty($form->thirdpartywaitlist)) {
        $form->thirdpartywaitlist = 0;
    }
    if (empty($form->confirmationsubject)) {
        $form->confirmationsubject = empty($CFG->facetoface_defaultconfirmationsubject) ? get_string('setting:defaultconfirmationsubjectdefault', 'facetoface') : $CFG->facetoface_defaultconfirmationsubject;
    }
    if (empty($form->confirmationinstrmngr)) {
        $form->emailmanagerconfirmation = 0;
        $form->confirmationinstrmngr = empty($CFG->facetoface_defaultconfirmationinstrmngr) ? get_string('setting:defaultconfirmationinstrmngrdefault', 'facetoface') : $CFG->facetoface_defaultconfirmationinstrmngr;
    } else {
        $form->emailmanagerconfirmation = 1;
    }
    if (empty($form->confirmationmessage)) {
        $form->confirmationmessage = empty($CFG->facetoface_defaultconfirmationmessage) ? get_string('setting:defaultconfirmationmessagedefault', 'facetoface') : $CFG->facetoface_defaultconfirmationmessage;
    }
    if (empty($form->remindersubject)) {
        $form->remindersubject = empty($CFG->facetoface_defaultremindersubject) ? get_string('setting:defaultremindersubjectdefault', 'facetoface') : $CFG->facetoface_defaultremindersubject;
    }
    if (empty($form->reminderinstrmngr)) {
        $form->emailmanagerreminder = 0;
        $form->reminderinstrmngr = empty($CFG->facetoface_defaultreminderinstrmngr) ? get_string('setting:defaultreminderinstrmngrdefault', 'facetoface') : $CFG->facetoface_defaultreminderinstrmngr;
    } else {
        $form->emailmanagerreminder = 1;
    }
    if (empty($form->remindermessage)) {
        $form->remindermessage = empty($CFG->facetoface_defaultremindermessage) ? get_string('setting:defaultremindermessagedefault', 'facetoface') : $CFG->facetoface_defaultremindermessage;
    }
    if (empty($form->cancellationsubject )) {
        $form->cancellationsubject = empty($CFG->facetoface_defaultcancellationsubject) ? get_string('setting:defaultcancellationsubjectdefault', 'facetoface') : $CFG->facetoface_defaultcancellationsubject;
    }
    if (empty($form->cancellationinstrmngr)) {
        $form->emailmanagercancellation = 0;
        $form->cancellationinstrmngr = empty($CFG->facetoface_defaultcancellationinstrmngr) ? get_string('setting:defaultcancellationinstrmngrdefault', 'facetoface') : $CFG->facetoface_defaultcancellationinstrmngr;

    } else {
        $form->emailmanagercancellation = 1;
    }
    if (empty($form->cancellationmessage)) {
        $form->cancellationmessage = empty($CFG->facetoface_defaultcancellationmessage) ? get_string('setting:defaultcancellationmessagedefault', 'facetoface') : $CFG->facetoface_defaultcancellationmessage;
    }
    if (empty($form->waitlistedsubject)) {
        $form->waitlistedsubject = empty($CFG->facetoface_defaultwaitlistedsubject) ? get_string('setting:defaultwaitlistedsubjectdefault', 'facetoface') : $CFG->facetoface_defaultwaitlistedsubject;
    }
    if (empty($form->waitlistedmessage)) {
        $form->waitlistedmessage = empty($CFG->facetoface_defaultwaitlistedmessage) ? get_string('setting:defaultwaitlistedmessagedefault', 'facetoface') : $CFG->facetoface_defaultwaitlistedmessage;
    }
    if (empty($form->display)) {
        $form->display = 6;
    }
    if (empty($form->reminderperiod)) {
        $form->reminderperiod = 2;
    }
?>

<script type="text/javascript">
//<![CDATA[
    var emailmanagerconfirmationitems = ['confirmationinstrmngr'];
    var emailmanagerreminderitems = ['reminderinstrmngr'];
    var emailmanagercancellationitems = ['cancellationinstrmngr'];
//]]>
</script>

<form name="form" method="post" action="mod.php">
<center>
<table cellpadding="5">
<tr valign="top">
    <td align="right"><b><?php print_string('facetofacename', 'facetoface') ?>:</b></td>
    <td align="left"><input type="text" name="name" size="40" value="<?php p($form->name) ?>" alt="<?php print_string('facetofacename', 'facetoface') ?>" /></td>
</tr>
<tr valign="top">
    <td align="right"><b><?php print_string('thirdpartyemailaddress', 'facetoface') ?>:</b></td>
    <td align="left"><input type="text" name="thirdparty" size="40" value="<?php p($form->thirdparty) ?>" alt="<?php print_string('thirdpartyemailaddress', 'facetoface') ?>" /> <?php helpbutton('thirdpartyemailaddress', get_string('thirdpartyemailaddress', 'facetoface'), 'facetoface'); ?></td>
</tr>
<tr valign="top">
    <td align="right"><b><?php print_string('thirdpartywaitlist', 'facetoface') ?>:</b></td>
    <td align="left"><input type="checkbox" name="thirdpartywaitlist" value="1" <?php print($form->thirdpartywaitlist ? 'checked="checked"' : ''); ?> alt="<?php print_string('thirdpartywaitlist', 'facetoface'); ?>" /> <?php helpbutton('thirdpartywaitlist', get_string('thirdpartywaitlist', 'facetoface'), 'facetoface'); ?></td>
</tr>
<tr valign="top">
    <td align="right"><b><?php print_string('sessionsoncoursepage', 'facetoface') ?>:</b></td>
    <td align="left"><?php
    for($i=0; $i<=18; $i=$i+2) $choices[$i] = $i;
    choose_from_menu($choices, 'display', $form->display, '');
    ?> <?php helpbutton('sessionsoncoursepage', get_string('sessionsoncoursepage', 'facetoface'), 'facetoface'); ?>
    </td>
</tr>
<tr valign="top">
    <td align="right"><h3><?php print_string('confirmationmessage', 'facetoface') ?> <?php helpbutton('confirmationmessage', get_string('confirmationmessage', 'facetoface'), 'facetoface'); ?></h3></td>
    <td></td>
</tr>
<tr valign="top">
    <td align="right"><b><?php print_string('email:subject', 'facetoface') ?>:</b></td>
    <td align="left"><input type="text" name="confirmationsubject" size="55" value="<?php p($form->confirmationsubject) ?>" alt="<?php print_string('email:subject', 'facetoface') ?>" /></td>
</tr>
<tr valign="top">
    <td align="right"><p><b><?php print_string('email:message', 'facetoface') ?>:</b></p>
    </td>
    <td align="left"><textarea name="confirmationmessage" rows="15" cols="70" alt="<?php print_string('email:message', 'facetoface') ?>"><?php p($form->confirmationmessage) ?></textarea></td>
</tr>
<tr valign="top">
    <td align="right"><b><?php print_string('emailmanager', 'facetoface') ?>:</b></td>
    <td align="left"><input name="emailmanagerconfirmation" type="checkbox" value="1" onclick="return lockoptions('form','emailmanagerconfirmation', emailmanagerconfirmationitems);" <?php if ($form->emailmanagerconfirmation) echo 'checked="checked"' ?> alt="<?php print_string('emailmanager', 'facetoface') ?>" /></td>
</tr>
<tr valign="top">
    <td align="right"><b><?php print_string('email:instrmngr', 'facetoface') ?>:</b></td>
    <td align="left"><textarea name="confirmationinstrmngr" rows="4" cols="70" alt="<?php print_string('email:instrmngr', 'facetoface') ?>"><?php p($form->confirmationinstrmngr) ?></textarea></td>
</tr>
<tr valign="top">
    <td align="right"><h3><?php print_string('remindermessage', 'facetoface') ?> <?php helpbutton('remindermessage', get_string('remindermessage', 'facetoface'), 'facetoface'); ?></h3></td>
    <td></td>
</tr>
<tr valign="top">
    <td align="right"><b><?php print_string('email:subject', 'facetoface') ?>:</b></td>
    <td align="left"><input type="text" name="remindersubject" size="55" value="<?php p($form->remindersubject) ?>" alt="<?php print_string('email:subject', 'facetoface') ?>" /></td>
</tr>
<tr valign="top">
    <td align="right"><p><b><?php print_string('email:message', 'facetoface') ?>:</b></p>
    </td>
    <td align="left"><textarea name="remindermessage" rows="15" cols="70" alt="<?php print_string('email:message', 'facetoface') ?>"><?php p($form->remindermessage) ?></textarea></td>
</tr>
<tr valign="top">
    <td align="right"><b><?php print_string('emailmanager', 'facetoface') ?>:</b></td>
    <td align="left"><input name="emailmanagerreminder" type="checkbox" value="1" onclick="return lockoptions('form','emailmanagerreminder', emailmanagerreminderitems);" <?php if ($form->emailmanagerreminder) echo 'checked="checked"' ?> alt="<?php print_string('emailmanager', 'facetoface') ?>" /></td>
</tr>
<tr valign="top">
    <td align="right"><b><?php print_string('email:instrmngr', 'facetoface') ?>:</b></td>
    <td align="left"><textarea name="reminderinstrmngr" rows="4" cols="70" alt="<?php print_string('email:instrmngr', 'facetoface') ?>"><?php p($form->reminderinstrmngr) ?></textarea></td>
</tr>
<tr valign="top">
    <td align="right"><b><?php print_string('reminderperiod', 'facetoface') ?>:</b></td>
    <td align="left"><?php
    unset($choices);
    for ($i=1; $i<=10; $i++) $choices[$i] = "$i";
    choose_from_menu ($choices, 'reminderperiod', $form->reminderperiod, '');
    ?>  <?php helpbutton('reminderperiod', get_string('reminderperiod', 'facetoface'), 'facetoface'); ?></td>
</tr>
<tr valign="top">
    <td align="right"><h3><?php print_string('waitlistedmessage', 'facetoface') ?> <?php helpbutton('waitlistedmessage', get_string('waitlistedmessage', 'facetoface'), 'facetoface'); ?></h3></td>
    <td></td>
</tr>
<tr valign="top">
    <td align="right"><b><?php print_string('email:subject', 'facetoface') ?>:</b></td>
    <td align="left"><input type="text" name="waitlistedsubject" size="55" value="<?php p($form->waitlistedsubject) ?>" alt="<?php print_string('email:subject', 'facetoface') ?>" /></td>
</tr>
<tr valign="top">
    <td align="right"><p><b><?php print_string('email:message', 'facetoface') ?>:</b></p>
    </td>
    <td align="left"><textarea name="waitlistedmessage" rows="15" cols="70" alt="<?php print_string('email:message', 'facetoface') ?>"><?php p($form->waitlistedmessage) ?></textarea></td>
</tr>
<tr valign="top">
    <td align="right"><h3><?php print_string('cancellationmessage', 'facetoface') ?> <?php helpbutton('cancellationmessage', get_string('cancellationmessage', 'facetoface'), 'facetoface'); ?></h3></td>
    <td></td>
</tr>
<tr valign="top">
    <td align="right"><b><?php print_string('email:subject', 'facetoface') ?>:</b></td>
    <td align="left"><input type="text" name="cancellationsubject" size="55" value="<?php p($form->cancellationsubject) ?>" alt="<?php print_string('email:subject', 'facetoface') ?>" /></td>
</tr>
<tr valign="top">
    <td align="right"><p><b><?php print_string('email:message', 'facetoface') ?>:</b></p>
    </td>
    <td align="left"><textarea name="cancellationmessage" rows="15" cols="70" alt="<?php print_string('email:message', 'facetoface') ?>"><?php p($form->cancellationmessage) ?></textarea></td>
</tr>
<tr valign="top">
    <td align="right"><b><?php print_string('emailmanager', 'facetoface') ?>:</b></td>
    <td align="left"><input name="emailmanagercancellation" type="checkbox" value="1" onclick="return lockoptions('form','emailmanagercancellation', emailmanagercancellationitems);" <?php if ($form->emailmanagercancellation) echo 'checked="checked"' ?> alt="<?php print_string('emailmanager', 'facetoface') ?>" /></td>
</tr>
<tr valign="top">
    <td align="right"><b><?php print_string('email:instrmngr', 'facetoface') ?>:</b></td>
    <td align="left"><textarea name="cancellationinstrmngr" rows="4" cols="70" alt="<?php print_string('email:instrmngr', 'facetoface') ?>"><?php p($form->cancellationinstrmngr) ?></textarea></td>
</tr>
</table>
</center>

<br />
<center>
<input type="hidden" name="course" value="<?php p($form->course) ?>" />
<input type="hidden" name="coursemodule" value="<?php p($form->coursemodule) ?>" />
<input type="hidden" name="section" value="<?php p($form->section) ?>" />
<input type="hidden" name="module" value="<?php p($form->module) ?>" />
<input type="hidden" name="modulename" value="<?php p($form->modulename) ?>" />
<input type="hidden" name="instance" value="<?php p($form->instance) ?>" />
<input type="hidden" name="mode" value="<?php p($form->mode) ?>" />
<input type="hidden" name="sesskey" value="<?php p($form->sesskey) ?>" />
<input type="submit" value="<?php print_string('savechanges') ?>" alt="<?php print_string('savechanges') ?>" />
<input type="submit" name="cancel" value="<?php print_string('cancel') ?>" alt="<?php print_string('cancel') ?>" />
</center>

</form>

<script type="text/javascript">
<?php
    if (!$form->emailmanagerconfirmation) echo "lockoptions('form','emailmanagerconfirmation', emailmanagerconfirmationitems);";
    if (!$form->emailmanagerreminder) echo "lockoptions('form','emailmanagerreminder', emailmanagerreminderitems);";
    if (!$form->emailmanagercancellation) echo "lockoptions('form','emailmanagercancellation', emailmanagercancellationitems);";
?>
</script>
